<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalue problem ¬∑ ApproxFun.jl</title><meta name="title" content="Eigenvalue problem ¬∑ ApproxFun.jl"/><meta property="og:title" content="Eigenvalue problem ¬∑ ApproxFun.jl"/><meta property="twitter:title" content="Eigenvalue problem ¬∑ ApproxFun.jl"/><meta name="description" content="Documentation for ApproxFun.jl."/><meta property="og:description" content="Documentation for ApproxFun.jl."/><meta property="twitter:description" content="Documentation for ApproxFun.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ApproxFun.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ApproxFun.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../../usage/domains/">Domains</a></li><li><a class="tocitem" href="../../usage/spaces/">Spaces</a></li><li><a class="tocitem" href="../../usage/constructors/">Constructors</a></li><li><a class="tocitem" href="../../usage/operators/">Operators</a></li><li><a class="tocitem" href="../../usage/equations/">Linear Equations</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ODE/">Solving ODEs</a></li><li><a class="tocitem" href="../system_of_eqn/">System of equations</a></li><li><a class="tocitem" href="../PDE/">Solving PDEs</a></li><li><a class="tocitem" href="../Sampling/">Sampling</a></li><li><a class="tocitem" href="../Periodic/">Periodic Domains</a></li><li class="is-active"><a class="tocitem" href>Eigenvalue problem</a><ul class="internal"><li><a class="tocitem" href="#Standard-eigenvalue-problem"><span>Standard eigenvalue problem</span></a></li><li><a class="tocitem" href="#Self-adjoint-Eigenvalue-Problem"><span>Self-adjoint Eigenvalue Problem</span></a></li></ul></li><li><a class="tocitem" href="../NonlinearBVP/">Nonlinear Boundary Value Problem</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/multivariate/">Multivariate functions</a></li><li><a class="tocitem" href="../../internals/blocks/">Blocks</a></li><li><a class="tocitem" href="../../internals/spaces/">Spaces</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Eigenvalue problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalue problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaApproximation/ApproxFun.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaApproximation/ApproxFun.jl/blob/master/examples/Eigenvalue.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalue-problem"><a class="docs-heading-anchor" href="#Eigenvalue-problem">Eigenvalue problem</a><a id="Eigenvalue-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalue-problem" title="Permalink"></a></h1><h2 id="Standard-eigenvalue-problem"><a class="docs-heading-anchor" href="#Standard-eigenvalue-problem">Standard eigenvalue problem</a><a id="Standard-eigenvalue-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-eigenvalue-problem" title="Permalink"></a></h2><p>In analogy to linear algebra, many differential equations may be posed as eigenvalue problems. That is, for some differential operator <span>$\mathop{L}$</span>, there are a family of functions <span>$\mathop{u}_i(x)$</span> such that</p><p class="math-container">\[\mathop{L} \mathop{u}_i(x) = Œª_i \mathop{u}_i(x),\]</p><p>where <span>$Œª_i$</span> is the <span>$i^{th}$</span> eigenvalue of the <span>$L$</span> and has a corresponding <em>eigenfunction</em> <span>$\mathop{u}_i(x)$</span>.</p><h3 id="Quantum-harmonic-oscillator"><a class="docs-heading-anchor" href="#Quantum-harmonic-oscillator">Quantum harmonic oscillator</a><a id="Quantum-harmonic-oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-harmonic-oscillator" title="Permalink"></a></h3><p>A classic eigenvalue problem is known as the quantum harmonic oscillator where</p><p class="math-container">\[\mathop{L} = -\frac{1}{2}\frac{\mathop{d}^2}{\mathop{dx}^2} + \frac{1}{2} x^2,\]</p><p>and one demands that <span>$\mathop{u}(‚àû) = \mathop{u}(-‚àû) = 0$</span>. Because we expect the solutions to be exponentially suppressed for large <span>$x$</span>, we can approximate this with Dirichlet boundary conditions at a &#39;reasonably large&#39; <span>$x$</span> without much difference.</p><p>We can express this in ApproxFun as the following:</p><pre><code class="language-julia hljs">using ApproxFun

x = Fun(-8..8)
V = x^2/2
L = -ùíü^2/2 + V
S = space(x)
B = Dirichlet(S)
Œª, v = ApproxFun.eigs(B, L, 500,tolerance=1E-10);</code></pre><p>Note that boundary conditions must be specified in the call to <code>eigs</code>. Plotting the first <span>$20$</span> eigenfunctions offset vertically by their eigenvalue, we see</p><pre><code class="language-julia hljs">import Plots
using LinearAlgebra: norm
p = Plots.plot(V, legend=false, ylim=(-Inf, Œª[22]))
for k=1:20
    Plots.plot!(real(v[k]) + real(Œª[k]))
end
p</code></pre><img src="7b14c01f.svg" alt="Example block output"/><p>If the solutions are not relatively constant near the boundary then one should push the boundaries further out.</p><p>For problems with different constraints or boundary conditions, <code>B</code> can be any zero functional constraint, e.g., <code>DefiniteIntegral()</code>.</p><h2 id="Self-adjoint-Eigenvalue-Problem"><a class="docs-heading-anchor" href="#Self-adjoint-Eigenvalue-Problem">Self-adjoint Eigenvalue Problem</a><a id="Self-adjoint-Eigenvalue-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Self-adjoint-Eigenvalue-Problem" title="Permalink"></a></h2><p>Ref: <a href="https://arxiv.org/abs/1903.08538">J. L. Aurentz &amp; R. M. Slevinsky (2019), arXiv:1903.08538</a></p><p>We solve the confined anharmonic oscillator</p><p class="math-container">\[\left[-\frac{d^2}{dx^2} + V(x)\right] u = Œªu,\]</p><p>where <span>$u(\pm 10) = 0$</span>, <span>$V(x) = œâx^2 + x^4$</span>, and <span>$œâ = 25$</span>.</p><pre><code class="language-julia hljs">using ApproxFun
using LinearAlgebra
using BandedMatrices</code></pre><p>Define parameters</p><pre><code class="language-julia hljs">œâ = 25.0
d = -10..10;
S = Legendre(d); # Equivalently, Ultraspherical(0.5, d)</code></pre><p>Construct the differential operator</p><pre><code class="language-julia hljs">V = Fun(x -&gt; œâ * x^2 + x^4, S)
L = -Derivative(S, 2) + V;</code></pre><p>Boundary conditions that are used in the basis recombination</p><pre><code class="language-julia hljs">B = Dirichlet(S);</code></pre><p>The system may be recast as a generalized eigenvalue problem <span>$A_S\,v = Œª\, B_S\, v$</span>, where <span>$A_S$</span> and <span>$B_S$</span> are symmetric band matrices. We wrap the operators in <code>SymmetricEigensystem</code> to implicitly perform the basis recombination</p><pre><code class="language-julia hljs">SEg = ApproxFun.SymmetricEigensystem(L, B);</code></pre><p>We construct <code>n √ó n</code> matrix representations of the operators that we diagonalize</p><pre><code class="language-julia hljs">n = 3000
Œª = eigvals(SEg, n);</code></pre><p>We retain a fraction of the eigenvalues with the least magnitude</p><pre><code class="language-julia hljs">Œª = Œª[1:round(Int, 3n/5)];</code></pre><p>We plot the eigenvalues</p><pre><code class="language-julia hljs">import Plots
Plots.plot(Œª, title = &quot;Eigenvalues&quot;, legend=false)</code></pre><img src="53ab324a.svg" alt="Example block output"/><h3 id="Infinite-well-with-a-barrier"><a class="docs-heading-anchor" href="#Infinite-well-with-a-barrier">Infinite well with a barrier</a><a id="Infinite-well-with-a-barrier-1"></a><a class="docs-heading-anchor-permalink" href="#Infinite-well-with-a-barrier" title="Permalink"></a></h3><p>We solve the Schrodinger equation in an infinite square well in the domain <code>-Lx/2..Lx/2</code>, with a finite barrier in the middle from <code>-d/2..d/2</code></p><p class="math-container">\[\mathop{L} = -\frac{1}{2}\frac{\mathop{d}^2}{\mathop{dx}^2} + V(x),\]</p><p>where <span>$V(x)$</span> is given by an infinite well with a smoothed barrier at the center.</p><p>We note that the system has parity symmetry, so the solutions may be separated into odd and even functions. We may therefore solve the problem only for half the domain, with Dirichlet boundary conditions at the midpoint for odd functions, and Neumann conditions for even functions. This projection to subspaces allows us to halve the sizes of matrices that we need to diagonalize</p><pre><code class="language-julia hljs">Lx = 4 # size of the domain
S = Legendre(0..Lx/2)
x = Fun(S)
d = 1 # size of the barrier
Œî = 0.1 # smoothing scale of the barrier
V = 50 * (1 - tanh((x - d/2)/Œî))/2; # right half of the potential barrier
H = -Derivative(S)^2/2 + V;</code></pre><p>Odd solutions, with a zero Dirichlet condition at <code>0</code> representing a node</p><pre><code class="language-julia hljs">B = Dirichlet(S);
Seig = ApproxFun.SymmetricEigensystem(H, B);</code></pre><p>Diagonalize <code>n √ó n</code> matrix representations of the basis-recombined operators We specify a tolerance to reject spurious solutions arising from the discretization</p><pre><code class="language-julia hljs">n = 100
Œªodd, vodd = ApproxFun.eigs(Seig, n, tolerance=1e-8);</code></pre><p>To extend the solutions to the full domain, we construct the left-half space.</p><pre><code class="language-julia hljs">Scomplement = Legendre(-Lx/2..0);</code></pre><p>We use the fact that Legendre polynomials of odd orders are odd functions, and those of even orders are even functions Using this, for the odd solutions, we negate the even-order coefficients to construct the odd image in <code>-Lx/2..0</code></p><pre><code class="language-julia hljs">function oddimage(f, Scomplement)
    coeffs = [(-1)^isodd(m) * c for (m,c) in enumerate(coefficients(f))]
    Fun(Scomplement, coeffs)
end
voddimage = oddimage.(vodd, Scomplement);</code></pre><p>Construct the functions over the entire domain <code>-Lx/2..Lx/2</code> as piecewise sums over the two half domains <code>-Lx/2..0</code> and <code>0..Lx/2</code> The eigenfunctions <code>vodd</code> are normalized on the half-domain, so we normalize the sum by dividing it by <code>‚àö2</code></p><pre><code class="language-julia hljs">voddfull = (voddimage .+ vodd)./‚àö2;</code></pre><p>Even solutions, with a Neumann condition at <code>0</code> representing the symmetry of the function</p><pre><code class="language-julia hljs">B = [lneumann(S); rdirichlet(S)];

Seig = ApproxFun.SymmetricEigensystem(H, B);
Œªeven, veven = ApproxFun.eigs(Seig, n, tolerance=1e-8);</code></pre><p>For the even solutions, we negate the odd-order coefficients to construct the even image in <code>-Lx/2..0</code></p><pre><code class="language-julia hljs">function evenimage(f, Scomplement)
    coeffs = [(-1)^iseven(m) * c for (m,c) in enumerate(coefficients(f))]
    Fun(Scomplement, coeffs)
end
vevenimage = evenimage.(veven, Scomplement);
vevenfull = (vevenimage .+ veven)./‚àö2;</code></pre><p>We interlace the eigenvalues and eigenvectors to obtain the entire spectrum</p><pre><code class="language-julia hljs">function interlace(a::AbstractVector, b::AbstractVector)
    vec(permutedims([a b]))
end
Œª = interlace(Œªeven, Œªodd);
v = interlace(vevenfull, voddfull);</code></pre><p>Symmetrize the potential using an even image (this is mainly for plotting/post-processing)</p><pre><code class="language-julia hljs">Vevenimage = evenimage(V, Scomplement);
Vfull = Vevenimage + V;</code></pre><p>We plot the first few eigenfunctions offset by their eigenvalues. The eigenfunctions appear in odd-even pairs by construction.</p><pre><code class="language-julia hljs">import Plots
using LinearAlgebra: norm
p1 = Plots.plot(Vfull, legend=false, ylim=(-Inf, Œª[14]), title=&quot;Eigenfunctions&quot;,
    seriestype=:path, linestyle=:dash, linewidth=2)
Plots.vline!([-Lx/2, Lx/2], color=:black)
for k=1:12
    Plots.plot!(real(v[k]) + Œª[k])
end</code></pre><p>Zoom into the ground state:</p><pre><code class="language-julia hljs">p2 = Plots.plot(Vfull, legend=false, ylim=(-Inf, Œª[3]), title=&quot;Ground state&quot;,
    seriestype=:path, linestyle=:dash, linewidth=2)
Plots.vline!([-Lx/2, Lx/2], color=:black)
Plots.plot!(real(v[1]) + Œª[1], linewidth=2)

Plots.plot(p1, p2, layout = 2)</code></pre><img src="9ab04dea.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Periodic/">¬´ Periodic Domains</a><a class="docs-footer-nextpage" href="../NonlinearBVP/">Nonlinear Boundary Value Problem ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 31 October 2023 12:40">Tuesday 31 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
