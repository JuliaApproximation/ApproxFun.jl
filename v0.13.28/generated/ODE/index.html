<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solving ODEs · ApproxFun.jl</title><meta name="title" content="Solving ODEs · ApproxFun.jl"/><meta property="og:title" content="Solving ODEs · ApproxFun.jl"/><meta property="twitter:title" content="Solving ODEs · ApproxFun.jl"/><meta name="description" content="Documentation for ApproxFun.jl."/><meta property="og:description" content="Documentation for ApproxFun.jl."/><meta property="twitter:description" content="Documentation for ApproxFun.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ApproxFun.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ApproxFun.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../../usage/domains/">Domains</a></li><li><a class="tocitem" href="../../usage/spaces/">Spaces</a></li><li><a class="tocitem" href="../../usage/constructors/">Constructors</a></li><li><a class="tocitem" href="../../usage/operators/">Operators</a></li><li><a class="tocitem" href="../../usage/equations/">Linear Equations</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Solving ODEs</a><ul class="internal"><li><a class="tocitem" href="#Boundary-value-problem"><span>Boundary value problem</span></a></li><li><a class="tocitem" href="#Initial-value-problem"><span>Initial value problem</span></a></li><li><a class="tocitem" href="#Increasing-Precision"><span>Increasing Precision</span></a></li></ul></li><li><a class="tocitem" href="../system_of_eqn/">System of equations</a></li><li><a class="tocitem" href="../PDE/">Solving PDEs</a></li><li><a class="tocitem" href="../Sampling/">Sampling</a></li><li><a class="tocitem" href="../Periodic/">Periodic Domains</a></li><li><a class="tocitem" href="../Eigenvalue/">Eigenvalue problem</a></li><li><a class="tocitem" href="../NonlinearBVP/">Nonlinear Boundary Value Problem</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/multivariate/">Multivariate functions</a></li><li><a class="tocitem" href="../../internals/blocks/">Blocks</a></li><li><a class="tocitem" href="../../internals/spaces/">Spaces</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Solving ODEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solving ODEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaApproximation/ApproxFun.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaApproximation/ApproxFun.jl/blob/master/examples/ODE.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solving-ODEs"><a class="docs-heading-anchor" href="#Solving-ODEs">Solving ODEs</a><a id="Solving-ODEs-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-ODEs" title="Permalink"></a></h1><h2 id="Boundary-value-problem"><a class="docs-heading-anchor" href="#Boundary-value-problem">Boundary value problem</a><a id="Boundary-value-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-value-problem" title="Permalink"></a></h2><p>We solve the <a href="https://en.wikipedia.org/wiki/Airy_function">Airy equation</a></p><p class="math-container">\[\frac{d^2 y}{dx^2}-x y = 0,\]</p><p>in an interval <code>a..b</code>, subject to the boundary conditions <span>$y(a)=\mathrm{Ai}(a)$</span> and <span>$y(b)=\mathrm{Ai}(b)$</span>, where <span>$\mathrm{Ai}$</span> represents the Airy function of the first kind.</p><pre><code class="language-julia hljs">using ApproxFun
using SpecialFunctions</code></pre><p>Construct the domain</p><pre><code class="language-julia hljs">a, b = -20, 10
d = a..b;</code></pre><p>We construct the Airy differential operator <span>$L = d^2/dx^2 - x$</span>:</p><pre><code class="language-julia hljs">x = Fun(d);
D = Derivative(d);
L = D^2 - x;</code></pre><p>We impose boundary conditions by setting the function at the boundaries equal to the values of the Airy function at these points. First, we construct the Dirichlet boundary condition operator, that evaluates the function at the boundaries</p><pre><code class="language-julia hljs">B = Dirichlet(d);</code></pre><p>The right hand side for the boundary condition is obtained by evaluating the Airy function We use <code>airyai</code> from <code>SpecialFunctions.jl</code> for this</p><pre><code class="language-julia hljs">B_vals = [airyai(a), airyai(b)];</code></pre><p>The main step, where we solve the differential equation</p><pre><code class="language-julia hljs">u = [B; L] \ [B_vals, 0];</code></pre><p>We plot the solution</p><pre><code class="language-julia hljs">import Plots
Plots.plot(u, xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, legend=false)</code></pre><img src="3d1eab1d.svg" alt="Example block output"/><h2 id="Initial-value-problem"><a class="docs-heading-anchor" href="#Initial-value-problem">Initial value problem</a><a id="Initial-value-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-value-problem" title="Permalink"></a></h2><h3 id="Undamped-harmonic-oscillator"><a class="docs-heading-anchor" href="#Undamped-harmonic-oscillator">Undamped harmonic oscillator</a><a id="Undamped-harmonic-oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Undamped-harmonic-oscillator" title="Permalink"></a></h3><p class="math-container">\[\frac{d^2 u}{dt^2} + 4 u = 0,\]</p><p>in an interval <code>0..2pi</code>, subject to the initial conditions <span>$u(0)=0$</span> and <span>$u&#39;(0)=2$</span>.</p><pre><code class="language-julia hljs">using ApproxFun
using LinearAlgebra</code></pre><p>Construct the domain</p><pre><code class="language-julia hljs">a, b = 0, 2pi
d = a..b;</code></pre><p>We construct the differential operator <span>$L = d^2/dx^2 + 4$</span>:</p><pre><code class="language-julia hljs">D = Derivative(d)
L = D^2 + 4;</code></pre><p>We have not chosen the space explicitly, and the solve chooses it to be <code>Chebyshev(d)</code> internally</p><p>We incorporate the initial conditions using <code>ivp</code>, which is a shortcut for evaluating the function and it&#39;s derivative at the left boundary of the domain</p><pre><code class="language-julia hljs">A = [L; ivp()];</code></pre><p>Initial conditions</p><pre><code class="language-julia hljs">u0 = 0;
dtu0 = 2;</code></pre><p>We solve the differential equation</p><pre><code class="language-julia hljs">u = \(A, [0,u0,dtu0], tolerance=1e-6);</code></pre><p>We plot the solution</p><pre><code class="language-julia hljs">t = a:0.1:b
Plots.plot(t, u.(t), xlabel=&quot;t&quot;, label=&quot;u(t)&quot;)
Plots.plot!(t, sin.(2t), label=&quot;Analytical&quot;, seriestype=:scatter)</code></pre><img src="8d442eb5.svg" alt="Example block output"/><h3 id="Damped-harmonic-oscillator"><a class="docs-heading-anchor" href="#Damped-harmonic-oscillator">Damped harmonic oscillator</a><a id="Damped-harmonic-oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Damped-harmonic-oscillator" title="Permalink"></a></h3><p class="math-container">\[\frac{d^2 y}{dt^2} + 2\zeta\omega_0\frac{dy}{dt} + \omega_0^2 y = 0,\]</p><p>from <span>$t=0$</span> to <span>$t=T$</span>, subject to the initial conditions <span>$y(0)=4$</span> and <span>$y&#39;(0)=0$</span>.</p><p>Construct the domain</p><pre><code class="language-julia hljs">T = 12
d = 0..T;

Dt = Derivative(d);
ζ = 0.2 # damping ratio
ω0 = 2 # oscillation frequency
L = Dt^2 + 2ζ * ω0 * Dt + ω0^2;</code></pre><p>initial conditions</p><pre><code class="language-julia hljs">y0 = 4; # initial displacement
dty0 = 3; # initial velocity</code></pre><p>The differential operator along with the initial condition evaluation operator</p><pre><code class="language-julia hljs">A = [L; ivp()];</code></pre><p>We solve the differential equation</p><pre><code class="language-julia hljs">y = \(A, [0,y0,dty0], tolerance=1e-6);</code></pre><p>Plot the solution</p><pre><code class="language-julia hljs">import Plots
Plots.plot(y, xlabel=&quot;t&quot;, ylabel=&quot;y(t)&quot;, legend=false)</code></pre><img src="a8cc0ef4.svg" alt="Example block output"/><h2 id="Increasing-Precision"><a class="docs-heading-anchor" href="#Increasing-Precision">Increasing Precision</a><a id="Increasing-Precision-1"></a><a class="docs-heading-anchor-permalink" href="#Increasing-Precision" title="Permalink"></a></h2><p>Solving differential equations with high precision types is available. The following calculates <span>$e$</span> to 300 digits by solving the ODE <span>$u^\prime = u$</span>:</p><pre><code class="language-julia hljs">using ApproxFun
u = setprecision(1000) do
    d = BigFloat(0)..BigFloat(1)
    D = Derivative(d)
    [ldirichlet(); D-1] \ [1; 0]
end;

import Plots
Plots.plot(u; legend=false, xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;)</code></pre><img src="5ff28f3f.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../usage/equations/">« Linear Equations</a><a class="docs-footer-nextpage" href="../system_of_eqn/">System of equations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 28 January 2025 16:36">Tuesday 28 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
